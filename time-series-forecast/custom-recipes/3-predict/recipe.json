// This file is the descriptor for the Custom code recipe clean
{
    // Meta data for display purposes
    "meta" : {
        "label" : "3. Predict",
        "description" : "Use previously trained models to predict future values or get historic residuals" ,
        "icon" : "icon-signal"
    },

    "kind" : "R",
    
    "selectableFromDataset" : "eval_dataset",

    // Inputs and outputs are defined by roles. In the recipe's I/O tab, the user can associate one
    // or more dataset to each input and output role.

    // The "arity" field indicates whether the user can associate several datasets to the role ('NARY')
    // or at most one ('UNARY'). The "required" field indicates whether the user is allowed to
    // associate no dataset with the role.

    "inputRoles" : [
        {
            "name": "model_folder",
            "label": "Saved model folder",
            "description": "Contains saved models from the \"Train\" recipe",
            "arity": "UNARY",
            "required": true,
            "acceptsDataset": false,
            "acceptsManagedFolder": true,
            "mustBeStrictlyType": "Filesystem"
        },
        {
            "name": "eval_dataset",
            "label": "Evaluation dataset",
            "description": "Result dataset from the \"Evaluate\" recipe",
            "arity": "UNARY",
            "required": false,
            "acceptsDataset": true,
            "acceptsFolder": false
        } 
    ],

    "outputRoles" : [
        {
            "name": "output_dataset",
            "label": "Output dataset",
            "description": "Will output forecasted values",
            "arity": "UNARY",
            "required": true,
            "acceptsDataset": true,
            "acceptsFolder": false
        } 
        // ...
    ],

    // The field "params" holds a list of all the params
    // for wich the user will be prompted for values in the Settings tab of the recipe.

    // The available parameter types are:
    // STRING, INT, DOUBLE, BOOLEAN, PASSWORD, SELECT, MAP, COLUMN, COLUMNS, TEXTAREA

    "params": [
        
        {
            "name": "separator_model_selection",
            "label": "Selecting which model(s) to use",
            "type": "SEPARATOR"
        },
        
        {
            "name": "AUTO_MODEL_SELECTION_ACTIVATED",
			"label" : "Automatic model selection",
			"description": "Automatically select model according to evaluated performance metrics",
            "type": "BOOLEAN",
            "defaultValue" : true,
			"mandatory" : true
        },
		
		// A "SELECT" parameter is a multi-choice selector. Choices are specified using the selectChoice field
        {
            "name": "SELECTED_MODEL",
            "label" : "Model to use",
            "type": "SELECT",
			"mandatory" : false,
            "defaultValue" : "naive",
            "visibilityCondition": "!model.AUTO_MODEL_SELECTION_ACTIVATED",
            "selectChoices": [

				{
                    "value": "naive",
                    "label": "Naive model"
                },
                {
                    "value": "seasonaltrend",
                    "label": "Seasonal Trend model"
                },
				{
                    "value": "neuralnetwork",
                    "label": "Neural Network model"
                },
				{
                    "value": "arima",
                    "label": "ARIMA model"
                },
                {
                    "value": "statespace",
                    "label": "State space model"
                }
            ]
        },
    
				
		// A "SELECT" parameter is a multi-choice selector. Choices are specified using the selectChoice field
        {
            "name": "METRIC_TO_OPTIMIZE",
            "label" : "Metric to optimize",
            "type": "SELECT",
			"mandatory" : false,
            "defaultValue" : "MASE",
            "visibilityCondition": "model.AUTO_MODEL_SELECTION_ACTIVATED",
            "selectChoices": [
                {
                    "value": "RMSE",
                    "label": "Root Mean Squared Error"
                },
				{
                    "value": "MAE",
                    "label": "Mean Absolute Error"
                },
                {
                    "value": "MAPE",
                    "label": "Mean Absolute Percentage Error"
                },
				{
                    "value": "MASE",
                    "label": "Mean Absolute Scaled Error"
                },
            ]
        },

        {
            "name": "CROSS_VALIDATION_STRATEGY",
            "label" : "Cross-validation strategy",
            "description": "Select which cross-validation results to use from \
                           the previous \"evaluate\" recipe",
            "type": "SELECT",
			"mandatory" : false,
            "defaultValue" : "test",
            "visibilityCondition": "model.AUTO_MODEL_SELECTION_ACTIVATED",
            "selectChoices": [
                {
                    "value": "test",
                    "label": "Test set"
                },
				{
                    "value": "multistepforecast",
                    "label": "Multi-step forecast"
                }
            ]
        },


        {
            "name": "separator_forecasting",
            "label": "Generating future values",
            "type": "SEPARATOR"
        },
        
        {
            "name": "NUMBER_OF_FORECAST_PERIODS",
            "label" : "Number of periods to forecast",
            "type": "INT",
            "mandatory" : true,
            "defaultValue" : 10
        },
        
        {
            "name": "CONFIDENCE_INTERVAL_LEVEL_1",
            "label" : "First confidence interval",
            "type": "INT",
            "mandatory" : true,
            "defaultValue" : 80,
            "description": "in percentage point"
        },
        
        {
            "name": "CONFIDENCE_INTERVAL_LEVEL_2",
            "label" : "Second confidence interval",
            "type": "INT",
            "mandatory" : true,
            "defaultValue" : 95,
            "description": "in percentage point"
        },
        
        {
            "name": "CONFIDENCE_LEVEL_BOOTSTRAP_ACTIVATED",
			"label" : "Bootstrap confidence intervals",
			"description": "Use statistical bootstrapping to get more robust confidence intervals. \
                            WARNING: it takes more time to compute.",
            "type": "BOOLEAN",
            "defaultValue" : false,
			"mandatory" : true
        }

        
    ],

    // The field "resourceKeys" holds a list of keys that allows to limit the number
    // of concurrent executions and activities triggered by this recipe.
    //
    // Administrators can configure the limit per resource key in the Administration > Settings > Flow build
    // screen.

    "resourceKeys" : []

}
